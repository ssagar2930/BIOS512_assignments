invisible({
suppressPackageStartupMessages(library(tidyverse))
# Get the data.
dialogs <- read_csv(
"https://raw.githubusercontent.com/Vincent-Toups/bios512/fcbc65a2696c7cff80d0f6ed1dd5c97abf0ef800/effective-visualization/source_data/tng.csv",
show_col_types = FALSE
)
head(dialogs, 10) # Showing first 10 observations
# Checkout the data.
names(dialogs)
dialogs %>% group_by(character) %>% tally() %>% arrange(desc(n))
dialogs %>% mutate(dialog_length=str_length(dialog)) %>% group_by(character) %>% summarize(mean_dialog_length = mean(dialog_length)) %>% arrange(desc(mean_dialog_length))
# Fix weird data.
dialogs %>% filter(character=="BEVERLY'S")
dialogs_fixed <- dialogs %>%
mutate(
character = str_replace_all(character, "'S.*$", ""),
character = str_replace_all(character, " VOICE", ""),
character = str_replace_all(character, "\\.", ""),
character = str_replace_all(character, "'", ""),
character = str_replace_all(character, "S COM", ""),
character = str_replace_all(character, " COM", ""),
dialog_length = str_length(dialog)
) %>%
filter(character %in% unlist(str_split("PICARD RIKER DATA TROI BEVERLY WORF WESLEY GEORDI", " ")))
dialogs_fixed %>% group_by(character) %>% summarize(mean_dialog_length = mean(dialog_length), std_dialog_length=sd(dialog_length)) %>% arrange(desc(mean_dialog_length))
dialog_len_per_ep <- dialogs_fixed %>% group_by(character, episode_number) %>% summarize(mean_dialog_length = mean(dialog_length), std_dialog_length=sd(dialog_length), .groups = "drop") %>% arrange(desc(mean_dialog_length))
dialog_len_per_ep
# Plot the data.
ggplot(dialogs_fixed) + geom_density(aes(x=dialog_length))
for_factor <- dialog_len_per_ep %>% group_by(character) %>% summarise(m=mean(mean_dialog_length)) %>% arrange(desc(m))
ggplot(dialog_len_per_ep, aes(factor(character,for_factor$character), mean_dialog_length)) + geom_boxplot()
dialog_len_per_ep <- dialogs_fixed %>%
group_by(character, episode_number) %>%
summarize(mean_dialog_length = mean(dialog_length), dialog_count=n(), .groups = "drop") %>%
arrange(desc(mean_dialog_length))
ggplot(dialog_len_per_ep, aes(dialog_count, mean_dialog_length)) + geom_point(aes(color=character)) + facet_wrap(~character)
})
ggplot(dialog_len_per_ep, aes(dialog_count, mean_dialog_length)) +
geom_point(aes(color=character)) +
facet_wrap(~character)
